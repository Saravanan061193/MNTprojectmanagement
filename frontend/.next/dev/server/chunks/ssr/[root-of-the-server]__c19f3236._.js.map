{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/SARAVANAN/OneDrive/Desktop/Client%20Data%20Management%20Software%20MNT/frontend/src/context/AuthContext.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\r\nimport { setCookie, deleteCookie, getCookie } from \"cookies-next\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport api from \"@/lib/api\";\r\n\r\ninterface User {\r\n    id: string;\r\n    name: string;\r\n    role: string;\r\n}\r\n\r\ninterface AuthContextType {\r\n    user: User | null;\r\n    login: (token: string, userData: User) => void;\r\n    logout: () => void;\r\n    isLoading: boolean;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n    const [user, setUser] = useState<User | null>(null);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const router = useRouter();\r\n\r\n    useEffect(() => {\r\n        const checkAuth = async () => {\r\n            const token = getCookie(\"token\");\r\n            if (token) {\r\n                // Optionally verify token with backend here\r\n                // For now, we assume if token exists, we might have user data in localStorage \r\n                // or we'd fetch /api/auth/me\r\n                const storedUser = localStorage.getItem(\"user\");\r\n                if (storedUser) {\r\n                    setUser(JSON.parse(storedUser));\r\n                }\r\n            }\r\n            setIsLoading(false);\r\n        };\r\n        checkAuth();\r\n    }, []);\r\n\r\n    const login = (token: string, userData: User) => {\r\n        setCookie(\"token\", token, { maxAge: 60 * 60 * 24 }); // 1 day\r\n        localStorage.setItem(\"user\", JSON.stringify(userData));\r\n        setUser(userData);\r\n        router.push(\"/dashboard\");\r\n    };\r\n\r\n    const logout = () => {\r\n        deleteCookie(\"token\");\r\n        localStorage.removeItem(\"user\");\r\n        setUser(null);\r\n        router.push(\"/\");\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, login, logout, isLoading }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n}\r\n\r\nexport function useAuth() {\r\n    const context = useContext(AuthContext);\r\n    if (context === undefined) {\r\n        throw new Error(\"useAuth must be used within an AuthProvider\");\r\n    }\r\n    return context;\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAoBA,MAAM,4BAAc,IAAA,sNAAa,EAA8B;AAExD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAC9D,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACN,MAAM,YAAY;YACd,MAAM,QAAQ,IAAA,4JAAS,EAAC;YACxB,IAAI,OAAO;gBACP,4CAA4C;gBAC5C,+EAA+E;gBAC/E,6BAA6B;gBAC7B,MAAM,aAAa,aAAa,OAAO,CAAC;gBACxC,IAAI,YAAY;oBACZ,QAAQ,KAAK,KAAK,CAAC;gBACvB;YACJ;YACA,aAAa;QACjB;QACA;IACJ,GAAG,EAAE;IAEL,MAAM,QAAQ,CAAC,OAAe;QAC1B,IAAA,4JAAS,EAAC,SAAS,OAAO;YAAE,QAAQ,KAAK,KAAK;QAAG,IAAI,QAAQ;QAC7D,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;QAC5C,QAAQ;QACR,OAAO,IAAI,CAAC;IAChB;IAEA,MAAM,SAAS;QACX,IAAA,+JAAY,EAAC;QACb,aAAa,UAAU,CAAC;QACxB,QAAQ;QACR,OAAO,IAAI,CAAC;IAChB;IAEA,qBACI,8OAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAO;YAAQ;QAAU;kBACzD;;;;;;AAGb;AAEO,SAAS;IACZ,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACvB,MAAM,IAAI,MAAM;IACpB;IACA,OAAO;AACX"}}]
}